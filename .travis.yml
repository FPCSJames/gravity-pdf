dist: trusty

language: php

sudo: required

services:
  - mysql
  - xvfb
  - docker

addons:
  firefox: latest
  apt:
    sources:
    - google-chrome
    - sourceline: 'deb https://dl.yarnpkg.com/debian/ stable main'
      key_url: 'https://dl.yarnpkg.com/debian/pubkey.gpg'
    packages:
    - yarn
    - google-chrome-stable fluxbox

cache:
  yarn: true
  directories:
  - $HOME/.composer/cache/files

php:
- 7.3

env:
- WP_VERSION=latest WP_MULTISITE=0 PLUGIN=gravity-forms-pdf-extended

before_script:
- "export DISPLAY=:99.0"
- "sh -e /etc/init.d/xvfb start"
- sleep 3
- fluxbox >/dev/null 2>&1 &
- ./bin/setup-local-env.sh

script:
- yarn run test:e2e:headless:chrome